# Number Drop 테스트 계획

> 각 Phase별 상세 테스트 케이스
> 생성일: 2026-01-03

---

# 테스트 유형

| 유형 | 설명 | 도구 |
|------|------|------|
| 단위 테스트 | 개별 함수/메서드 테스트 | Jest, Vitest |
| 통합 테스트 | 컴포넌트 간 상호작용 | Jest |
| E2E 테스트 | 전체 사용자 플로우 | Playwright |
| 시각적 테스트 | UI 스크린샷 비교 | Playwright |
| 성능 테스트 | FPS, 메모리 사용량 | Chrome DevTools |
| 호환성 테스트 | 다양한 기기/브라우저 | BrowserStack |

---

# 🔴 Phase 1: 벤치마크 일치

## 1.1 블록 색상 시스템 테스트

### 단위 테스트
- [ ] `getColorByValue(2)` → `0x90EE90` 반환
- [ ] `getColorByValue(4)` → `0x4ECDC4` 반환
- [ ] `getColorByValue(8)` → `0x45B7D1` 반환
- [ ] `getColorByValue(16)` → `0x5D6BE8` 반환
- [ ] `getColorByValue(32)` → `0xE8875D` 반환
- [ ] `getColorByValue(64)` → `0xE85D8C` 반환
- [ ] `getColorByValue(128)` → `0x7BA3A8` 반환
- [ ] `getColorByValue(256)` → `0xE85DA8` 반환
- [ ] `getColorByValue(512)` → `0x5DE87B` 반환
- [ ] `getColorByValue(1024)` → `0x888888` 반환
- [ ] `getColorByValue(2048)` → `0xFF8C00` 반환
- [ ] `getColorByValue(4096)` → `0x9B59B6` 반환
- [ ] `getColorByValue(8192)` → 기본값 또는 정의된 색상 반환
- [ ] 정의되지 않은 숫자 → 기본 색상 반환

### 통합 테스트
- [ ] 블록 생성 시 올바른 색상 적용 확인
- [ ] 블록 병합 후 새 색상 적용 확인
- [ ] 색상 변경 시 기존 블록 업데이트 확인

### 시각적 테스트
- [ ] 모든 숫자 블록 스크린샷 캡처
- [ ] 벤치마크 스크린샷과 색상 비교
- [ ] 다크 모드에서 가독성 확인

### 테스트 데이터
```typescript
const colorTestCases = [
  { value: 2, expected: 0x90EE90 },
  { value: 4, expected: 0x4ECDC4 },
  // ...
];
```

---

## 1.2 특수 블록 효과 테스트

### 단위 테스트
- [ ] `isSpecialBlock(2048)` → `true` 반환
- [ ] `isSpecialBlock(4096)` → `true` 반환
- [ ] `isSpecialBlock(1024)` → `false` 반환
- [ ] `isSpecialBlock(512)` → `false` 반환

### 통합 테스트
- [ ] 2048 블록 생성 시 왕관 아이콘 표시
- [ ] 4096 블록 생성 시 왕관 아이콘 표시
- [ ] 2048 블록 생성 시 glow 효과 활성화
- [ ] 4096 블록 생성 시 glow 효과 활성화
- [ ] 일반 블록에는 특수 효과 없음

### 애니메이션 테스트
- [ ] 반짝임 효과 재생 확인
- [ ] 애니메이션 루프 정상 동작
- [ ] 애니메이션 타이밍 적절성
- [ ] 여러 특수 블록 동시 표시 시 성능

### 성능 테스트
- [ ] 특수 블록 10개 이상 시 FPS 유지 (60fps)
- [ ] 메모리 누수 없음 확인
- [ ] 파티클 효과 시 성능 저하 없음

---

## 1.3 콤보 팝업 UI 테스트

### 단위 테스트
- [ ] `calculateCombo()` 정확한 콤보 수 반환
- [ ] 콤보 리셋 조건 동작 확인

### 통합 테스트
- [ ] 2콤보 발생 시 팝업 표시
- [ ] 3콤보 발생 시 팝업 갱신
- [ ] 5콤보 발생 시 팝업 표시
- [ ] 10콤보 발생 시 팝업 표시
- [ ] 콤보 종료 후 팝업 사라짐

### 애니메이션 테스트
- [ ] 팝업 페이드 인 (0.2초)
- [ ] 팝업 유지 (0.5초)
- [ ] 팝업 페이드 아웃 (0.3초)
- [ ] 연속 콤보 시 애니메이션 재시작

### 시각적 테스트
- [ ] 팝업 위치 (화면 중앙)
- [ ] 팝업 크기 적절성
- [ ] 폰트 가독성
- [ ] 골드 프레임 디자인 확인

### 엣지 케이스
- [ ] 매우 빠른 연속 콤보 처리
- [ ] 게임 오버 직전 콤보 표시
- [ ] 화면 전환 시 팝업 정리

---

## 1.4 블록 미리보기 레이아웃 테스트

### 단위 테스트
- [ ] `getCurrentBlock()` 정확한 값 반환
- [ ] `getNextBlock()` 정확한 값 반환
- [ ] 블록 생성 후 미리보기 업데이트

### 통합 테스트
- [ ] 현재 블록 표시 위치 확인 (그리드 상단 중앙)
- [ ] 다음 블록 표시 위치 확인 (현재 블록 우측)
- [ ] 블록 드롭 후 미리보기 갱신
- [ ] 현재 블록 크기 (60x60)
- [ ] 다음 블록 크기 (40x40)

### 시각적 테스트
- [ ] 미리보기가 그리드와 겹치지 않음
- [ ] 두 미리보기 간격 적절
- [ ] 블록 색상 정확히 표시

### 반응형 테스트
- [ ] 좁은 화면 (320px) 레이아웃
- [ ] 넓은 화면 (768px) 레이아웃
- [ ] 태블릿 화면 레이아웃

---

## 1.5 상단 UI 재배치 테스트

### 1.5.1 코인 표시 테스트
- [ ] 코인 아이콘 표시 확인
- [ ] 코인 숫자 정확성
- [ ] + 버튼 클릭 → 광고 화면
- [ ] 코인 증가 애니메이션
- [ ] 코인 감소 애니메이션

### 1.5.2 최고점수 테스트
- [ ] 왕관 아이콘 표시
- [ ] 최고점수 숫자 정확성
- [ ] 신기록 달성 시 업데이트
- [ ] 게임 재시작 후 유지

### 1.5.3 글로벌 랭킹 테스트
- [ ] 지구 아이콘 표시
- [ ] 랭킹 숫자 표시 (#형식)
- [ ] 점수 변경 시 랭킹 업데이트
- [ ] 네트워크 오류 시 처리

### 1.5.4 되돌리기 버튼 테스트
- [ ] 버튼 표시 확인
- [ ] 클릭 시 되돌리기 실행
- [ ] 사용 불가 시 비활성화 표시
- [ ] 코인 차감 (해당 시)

### 1.5.5 버튼 상호작용 테스트
- [ ] 각 버튼 터치 영역 적절
- [ ] 버튼 간 간격 충분
- [ ] 호버 효과 (웹)
- [ ] 클릭 피드백

### 레이아웃 테스트
- [ ] 모든 요소 화면 내 표시
- [ ] 요소 간 겹침 없음
- [ ] 다양한 화면 크기 대응

---

## 1.6 글로벌 랭킹 실시간 테스트

### API 테스트
- [ ] `getRankByScore(1000)` API 응답 확인
- [ ] `getRankByScore(10000)` API 응답 확인
- [ ] `getRankByScore(100000)` API 응답 확인
- [ ] API 응답 시간 < 500ms

### 통합 테스트
- [ ] 게임 시작 시 초기 랭킹 표시
- [ ] 점수 증가 시 랭킹 갱신
- [ ] 랭크업 시 팝업 표시
- [ ] 랭크다운 처리 (해당 시)

### 랭크업 팝업 테스트
- [ ] 팝업 표시 타이밍
- [ ] 이전 랭킹 → 새 랭킹 표시
- [ ] 애니메이션 동작
- [ ] 팝업 자동 닫힘

### 오프라인 테스트
- [ ] 네트워크 끊김 시 처리
- [ ] 재연결 시 랭킹 동기화
- [ ] 오류 메시지 표시

### 성능 테스트
- [ ] API 호출 빈도 적절 (디바운스)
- [ ] 캐싱 동작 확인
- [ ] 동시 요청 처리

---

# 🟡 Phase 2: 기본 차별화

## 2.1 업적 시스템 테스트

### 단위 테스트
```typescript
// 업적 조건 테스트
- [ ] checkAchievement('first_merge', { mergeCount: 1 }) → true
- [ ] checkAchievement('first_merge', { mergeCount: 0 }) → false
- [ ] checkAchievement('reach_512', { highestBlock: 512 }) → true
- [ ] checkAchievement('reach_2048', { highestBlock: 1024 }) → false
- [ ] checkAchievement('combo_5', { maxCombo: 5 }) → true
- [ ] checkAchievement('score_10000', { score: 15000 }) → true
```

### 통합 테스트

#### 블록 달성 업적
- [ ] 512 블록 생성 → '512 달성' 업적 해금
- [ ] 1024 블록 생성 → '1024 달성' 업적 해금
- [ ] 2048 블록 생성 → '2048 달성' 업적 해금
- [ ] 4096 블록 생성 → '4096 달성' 업적 해금

#### 점수 달성 업적
- [ ] 10,000점 달성 → '10,000점' 업적 해금
- [ ] 100,000점 달성 → '100,000점' 업적 해금

#### 콤보 업적
- [ ] 5콤보 달성 → '5콤보' 업적 해금
- [ ] 10콤보 달성 → '10콤보' 업적 해금

#### 플레이 업적
- [ ] 100게임 플레이 → '100게임' 업적 해금
- [ ] 7일 연속 접속 → '7일 연속' 업적 해금

### 보상 테스트
- [ ] 업적 해금 시 코인 지급
- [ ] 정확한 보상량 지급
- [ ] 중복 지급 방지

### 알림 테스트
- [ ] 업적 해금 팝업 표시
- [ ] 팝업 내용 정확성 (아이콘, 이름, 보상)
- [ ] 연속 업적 해금 시 순차 표시

### 저장/로드 테스트
- [ ] 업적 상태 LocalStorage 저장
- [ ] 앱 재시작 후 업적 상태 유지
- [ ] 데이터 손상 시 복구

---

## 2.2 통계 화면 테스트

### 단위 테스트
```typescript
- [ ] updateStats({ score: 1000 }) → totalScore 증가
- [ ] updateStats({ merges: 5 }) → totalMerges 증가
- [ ] getAverageScore() → 정확한 평균 계산
- [ ] getHighestBlock() → 최대 블록 반환
```

### 통합 테스트

#### 통계 수집
- [ ] 게임 시작 → totalGames 증가
- [ ] 게임 종료 → totalScore 누적
- [ ] 병합 발생 → totalMerges 증가
- [ ] 신기록 → highScore 갱신
- [ ] 플레이 시간 정확히 기록

#### 통계 표시
- [ ] 총 게임 수 표시
- [ ] 평균 점수 표시
- [ ] 최고 점수 표시
- [ ] 최고 블록 표시
- [ ] 총 병합 수 표시
- [ ] 총 플레이 시간 표시

#### 그래프 테스트
- [ ] 일별 점수 그래프 렌더링
- [ ] 최근 7일 데이터 표시
- [ ] 데이터 없는 날 처리
- [ ] 그래프 스케일 적절성

### 저장/로드 테스트
- [ ] 통계 데이터 저장
- [ ] 앱 재시작 후 통계 유지
- [ ] 대용량 데이터 처리

---

## 2.3 추가 아이템 테스트

### 2.3.1 분할 아이템 (➗)

#### 단위 테스트
- [ ] `divideBlock(1024)` → 512 반환
- [ ] `divideBlock(512)` → 256 반환
- [ ] `divideBlock(4)` → 2 반환
- [ ] `divideBlock(2)` → 사용 불가

#### 통합 테스트
- [ ] 아이템 버튼 클릭 → 선택 모드
- [ ] 블록 선택 → 분할 실행
- [ ] 분할 후 블록 값 변경 확인
- [ ] 분할 후 색상 변경 확인
- [ ] 코인 150 차감 확인

#### 엣지 케이스
- [ ] 2 블록 선택 시 사용 불가 표시
- [ ] 빈 셀 선택 시 무시
- [ ] 취소 버튼 동작

### 2.3.2 픽업 아이템 (🎯)

#### 단위 테스트
- [ ] `pickupBlock(0, 0, 2, 3)` → 블록 이동
- [ ] 원래 위치 빈 셀로 변경
- [ ] 새 위치에 블록 배치

#### 통합 테스트
- [ ] 아이템 버튼 클릭 → 선택 모드
- [ ] 블록 선택 → 위치 선택 모드
- [ ] 새 위치 선택 → 이동 실행
- [ ] 코인 200 차감 확인

#### 엣지 케이스
- [ ] 빈 셀로 이동
- [ ] 같은 숫자 블록 위로 이동 (병합)
- [ ] 다른 숫자 블록 위로 이동 (불가)
- [ ] 취소 버튼 동작

### 2.3.3 제거 아이템 (🗑️)

#### 단위 테스트
- [ ] `removeBlock(x, y)` → 해당 셀 null
- [ ] 위 블록들 중력 적용

#### 통합 테스트
- [ ] 아이템 버튼 클릭 → 선택 모드
- [ ] 블록 선택 → 제거 실행
- [ ] 블록 사라짐 확인
- [ ] 위 블록 낙하 확인
- [ ] 코인 120 차감 확인

#### 엣지 케이스
- [ ] 빈 셀 선택 시 무시
- [ ] 최하단 블록 제거
- [ ] 연쇄 병합 발생 케이스

---

## 2.4 되돌리기 버튼 테스트

### 단위 테스트
```typescript
- [ ] saveState() → stateHistory 증가
- [ ] undo() → 이전 상태 복원
- [ ] canUndo() → 되돌리기 가능 여부
```

### 통합 테스트

#### 기본 동작
- [ ] 블록 드롭 전 상태 저장
- [ ] 되돌리기 클릭 → 이전 상태 복원
- [ ] 블록 위치 복원 확인
- [ ] 점수 복원 확인
- [ ] 미리보기 복원 확인

#### 제한 사항
- [ ] 게임 시작 직후 되돌리기 불가
- [ ] 연속 되돌리기 제한 (설정에 따라)
- [ ] 코인 차감 (해당 시)

#### UI 테스트
- [ ] 사용 가능 시 버튼 활성화
- [ ] 사용 불가 시 버튼 비활성화
- [ ] 남은 횟수 표시 (해당 시)

### 엣지 케이스
- [ ] 병합 직후 되돌리기
- [ ] 콤보 중 되돌리기
- [ ] 아이템 사용 후 되돌리기

---

# 🟢 Phase 3: 확장 기능

## 3.1 타임 어택 모드 테스트

### 단위 테스트
- [ ] 타이머 초기화 (60/120/180초)
- [ ] 타이머 감소 정확성
- [ ] 시간 종료 감지

### 통합 테스트

#### 모드 선택
- [ ] 메뉴에서 타임 어택 선택
- [ ] 시간 선택 (60/120/180초)
- [ ] 게임 시작

#### 게임플레이
- [ ] 타이머 표시 정확성
- [ ] 시간 종료 시 게임 오버
- [ ] 게임 오버 화면 표시
- [ ] 점수 기록

#### 랭킹
- [ ] 타임 어택 별도 랭킹 저장
- [ ] 시간별 랭킹 분리
- [ ] 랭킹 보드 표시

### UI 테스트
- [ ] 타이머 위치 적절
- [ ] 시간 부족 시 경고 (빨간색)
- [ ] 타이머 애니메이션

---

## 3.2 스킨/테마 시스템 테스트

### 단위 테스트
- [ ] `getSkinColors('fruit')` → 과일 색상 반환
- [ ] `applyTheme('neon')` → 테마 적용
- [ ] `purchaseSkin('gem')` → 구매 처리

### 통합 테스트

#### 스킨 테스트
- [ ] 스킨 변경 → 블록 색상 변경
- [ ] 스킨 저장 → 재시작 후 유지
- [ ] 미구매 스킨 잠금 표시

#### 테마 테스트
- [ ] 테마 변경 → 배경 변경
- [ ] 테마 변경 → UI 색상 변경
- [ ] 테마 저장 → 재시작 후 유지

#### 상점 테스트
- [ ] 상점 화면 표시
- [ ] 스킨/테마 목록 표시
- [ ] 가격 표시
- [ ] 구매 버튼 동작
- [ ] 코인 차감 확인
- [ ] 구매 완료 후 잠금 해제

---

## 3.3 친구 시스템 테스트

### API 테스트
- [ ] POST /api/friends/add 성공
- [ ] POST /api/friends/add 중복 방지
- [ ] GET /api/friends/list 목록 반환
- [ ] DELETE /api/friends/remove 삭제
- [ ] GET /api/friends/ranking 랭킹 반환

### 통합 테스트

#### 친구 추가
- [ ] 초대 코드 입력
- [ ] 친구 추가 성공
- [ ] 친구 목록에 표시

#### 친구 목록
- [ ] 친구 목록 표시
- [ ] 친구 점수 표시
- [ ] 친구 삭제 기능

#### 친구 랭킹
- [ ] 친구 랭킹 보드 표시
- [ ] 내 순위 표시
- [ ] 실시간 업데이트

### 오프라인 테스트
- [ ] 네트워크 없을 때 캐시 표시
- [ ] 재연결 시 동기화

---

## 3.4 하단 아이템 바 개선 테스트

### 통합 테스트

#### 광고 보상 표시
- [ ] "+111 코인" 표시
- [ ] 쿨타임 타이머 표시
- [ ] 쿨타임 종료 후 활성화

#### 아이템 바 확장
- [ ] 스크롤 동작 (해당 시)
- [ ] 2줄 레이아웃 (해당 시)
- [ ] 아이템 추가 시 UI 조정

### UI 테스트
- [ ] 아이템 아이콘 표시
- [ ] 가격 표시
- [ ] 터치 영역 적절

---

# 🔵 Phase 4: 혁신 기능

## 4.1 대전 모드 테스트

### 연결 테스트
- [ ] WebSocket 연결 성공
- [ ] 매칭 요청/응답
- [ ] 연결 끊김 처리

### 동기화 테스트
- [ ] 블록 드롭 동기화
- [ ] 점수 동기화
- [ ] 게임 오버 동기화

### 승패 테스트
- [ ] 먼저 게임 오버 → 패배
- [ ] 상대 게임 오버 → 승리
- [ ] 동시 게임 오버 → 점수 비교

---

## 4.2 물리 엔진 테스트

### 물리 동작 테스트
- [ ] 블록 낙하 물리 적용
- [ ] 블록 충돌 처리
- [ ] 블록 굴러가는 효과
- [ ] 블록 밀리는 효과

### 병합 테스트
- [ ] 물리 충돌로 병합 트리거
- [ ] 병합 후 물리 상태 정리

### 성능 테스트
- [ ] 물리 연산 FPS 유지
- [ ] 많은 블록 시 성능

---

## 4.3 시즌 패스 테스트

### 경험치 테스트
- [ ] 게임 플레이로 경험치 획득
- [ ] 레벨업 계산 정확성
- [ ] 레벨 표시

### 보상 테스트
- [ ] 무료 트랙 보상 지급
- [ ] 프리미엄 트랙 보상 지급
- [ ] 보상 수령 확인

### 구매 테스트
- [ ] 프리미엄 패스 구매
- [ ] 결제 처리
- [ ] 구매 후 트랙 활성화

---

## 4.4 3D 모드 테스트

### 렌더링 테스트
- [ ] 3D 큐브 렌더링
- [ ] 블록 3D 표시
- [ ] 카메라 회전

### 조작 테스트
- [ ] 터치로 회전
- [ ] 블록 드롭 방향
- [ ] 3D 공간에서 병합

### 성능 테스트
- [ ] 3D 렌더링 FPS
- [ ] 모바일 성능

---

# 크로스 플랫폼 테스트

## 브라우저 테스트

### 데스크톱
- [ ] Chrome (최신)
- [ ] Firefox (최신)
- [ ] Safari (최신)
- [ ] Edge (최신)

### 모바일
- [ ] iOS Safari
- [ ] Android Chrome
- [ ] Samsung Internet

## 기기 테스트

### 화면 크기
- [ ] 320px (작은 모바일)
- [ ] 375px (iPhone SE)
- [ ] 390px (iPhone 12/13)
- [ ] 428px (iPhone 12 Pro Max)
- [ ] 768px (태블릿)
- [ ] 1024px (데스크톱)

### 성능 테스트
- [ ] 저사양 기기 (60fps 유지)
- [ ] 고사양 기기 (60fps 유지)
- [ ] 배터리 소모량

---

# 회귀 테스트 체크리스트

## 각 릴리스 전 필수 테스트

### 핵심 기능
- [ ] 게임 시작
- [ ] 블록 드롭
- [ ] 블록 병합
- [ ] 점수 계산
- [ ] 게임 오버
- [ ] 저장/불러오기

### UI/UX
- [ ] 모든 버튼 동작
- [ ] 화면 전환
- [ ] 애니메이션

### 데이터
- [ ] 점수 저장
- [ ] 설정 저장
- [ ] 코인 저장

---

# 테스트 자동화

## CI/CD 파이프라인

```yaml
# .github/workflows/test.yml
name: Test

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
      - run: npm ci
      - run: npm run test:unit
      - run: npm run test:e2e
```

## 테스트 스크립트

```json
{
  "scripts": {
    "test": "vitest",
    "test:unit": "vitest run",
    "test:e2e": "playwright test",
    "test:visual": "playwright test --update-snapshots"
  }
}
```

---

# 버그 리포트 템플릿

```markdown
## 버그 설명
[버그에 대한 간단한 설명]

## 재현 단계
1. '...'로 이동
2. '...'를 클릭
3. '...'까지 스크롤
4. 오류 발생

## 예상 동작
[예상했던 동작]

## 실제 동작
[실제로 발생한 동작]

## 스크린샷
[해당되는 경우 스크린샷 첨부]

## 환경
- 기기: [예: iPhone 12]
- OS: [예: iOS 15.0]
- 브라우저: [예: Safari]
- 앱 버전: [예: v1.2]
```

---

*최종 업데이트: 2026-01-03*
